<Window x:Class="Calsto_Production.PackingSlip"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Packing Slip" Height="842" Width="595"
        WindowStartupLocation="CenterScreen"
        Background="#F5F6F5"
        FontFamily="Segoe UI, Arial"
        FontSize="12">

    <Window.Resources>
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#1E88E5"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#4A4A4A"/>
            <Setter Property="Margin" Value="0,0,10,4"/>
        </Style>
        <Style x:Key="ValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#1A2526"/>
        </Style>
        <Style x:Key="DataGridHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#E8ECEF"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#4A4A4A"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="#D3D8DE"/>
        </Style>
        <Style x:Key="DataGridRowStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F0F4F8"/>
                </Trigger>
                <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                    <Setter Property="Background" Value="#FFFFFF"/>
                </Trigger>
                <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                    <Setter Property="Background" Value="#F9FAFB"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="DataGridCellStyle" TargetType="DataGridCell">
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Foreground" Value="#1A2526"/>
        </Style>
        <Style x:Key="PrintButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#1E88E5"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1565C0"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Image Grid.Column="0"
                   Source="/Resources/CALSTO-NEW.png"
                   Stretch="Uniform"
                   Width="80"
                   Height="45"
                   VerticalAlignment="Center"
                   ToolTip="Craftsman Storage System Logo"/>

            <StackPanel Grid.Column="1"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Center">
                <TextBlock Text="CRAFTSMAN STORAGE SYSTEM (PUNE 4)"
                           FontWeight="SemiBold"
                           Foreground="#2F4157"
                           FontSize="12"
                           HorizontalAlignment="Center"/>
                <TextBlock Text="PACKING SLIP"
                           FontWeight="Bold"
                           FontSize="14"
                           Foreground="#1E88E5"
                           HorizontalAlignment="Center"/>
            </StackPanel>

            <Image Grid.Column="2"
                   Source="/Resources/CA_Storage_Logo-removebg-preview.png"
                   Stretch="Uniform"
                   Width="80"
                   Height="25"
                   VerticalAlignment="Center"
                   ToolTip="CA Storage Logo"/>
        </Grid>

        <!-- Project Details & QR -->
        <Grid Grid.Row="1" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <TextBlock Text="PROJECT DETAILS"
                           Style="{StaticResource SectionHeaderStyle}"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" MinWidth="100"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0"
                               Text="Customer:"
                               Style="{StaticResource LabelStyle}"/>
                    <TextBlock Grid.Row="0" Grid.Column="1"
                               Text="{Binding CustomerName}"
                               Style="{StaticResource ValueStyle}"
                               ToolTip="{Binding CustomerName}"/>

                    <TextBlock Grid.Row="1" Grid.Column="0"
                               Text="Location:"
                               Style="{StaticResource LabelStyle}"/>
                    <TextBlock Grid.Row="1" Grid.Column="1"
                               Text="{Binding CustomerLocation}"
                               Style="{StaticResource ValueStyle}"
                               ToolTip="{Binding CustomerLocation}"/>

                    <TextBlock Grid.Row="2" Grid.Column="0"
                               Text="Project No:"
                               Style="{StaticResource LabelStyle}"/>
                    <TextBlock Grid.Row="2" Grid.Column="1"
                               Text="{Binding ProjectNo}"
                               Style="{StaticResource ValueStyle}"
                               ToolTip="{Binding ProjectNo}"/>
                </Grid>
            </StackPanel>

            <StackPanel Grid.Column="1"
                        HorizontalAlignment="Right"
                        Margin="20,0,0,0"
                        VerticalAlignment="Top">
                <TextBlock Text="BUNDLE QR"
                           Style="{StaticResource SectionHeaderStyle}"
                           HorizontalAlignment="Center"/>
                <Image x:Name="imgQRCode"
                       Stretch="Uniform"
                       Width="90"
                       Height="90"/>
                <TextBlock Text="{Binding PackageID}"
                           Style="{StaticResource ValueStyle}"
                           HorizontalAlignment="Center"
                           Margin="0,5,0,0"
                           FontWeight="SemiBold"/>
            </StackPanel>
        </Grid>

        <!-- Table with Watermark -->
        <Grid Grid.Row="2" Margin="0,0,0,16">
            <Image Source="/Resources/CALSTO-NEW.png"
                   Opacity="0.06"
                   Stretch="Uniform"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Center"
                   IsHitTestVisible="False"/>

            <DataGrid x:Name="dgComponentList"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      IsReadOnly="True"
                      Background="Transparent"
                      GridLinesVisibility="None"
                      HeadersVisibility="Column"
                      BorderThickness="0"
                      
                      >
                <DataGrid.Resources>
                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource DataGridHeaderStyle}"/>
                    <Style TargetType="DataGridRow" BasedOn="{StaticResource DataGridRowStyle}"/>
                    <Style TargetType="DataGridCell" BasedOn="{StaticResource DataGridCellStyle}"/>
                </DataGrid.Resources>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Sr#" Binding="{Binding SrNo}" Width="50"/>
                    <DataGridTextColumn Header="WID" Binding="{Binding WID}" Width="120"/>
                    <DataGridTextColumn Header="Part Number" Binding="{Binding PartNumber}" Width="140"/>
                    <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
                    <DataGridTextColumn Header="Qty" Binding="{Binding QtyInPackage}" Width="60"/>
                    <DataGridTextColumn Header="Remarks" Binding="{Binding Remarks}" Width="120"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>

        <!-- Footer with Print Button -->
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" VerticalAlignment="Bottom">
                <TextBlock Text="Prepared By:"
                           Style="{StaticResource LabelStyle}"/>
                <Rectangle Height="1"
                           Fill="#D3D8DE"
                           Margin="0,0,0,8"/>
                <TextBlock Text="Date:"
                           Style="{StaticResource LabelStyle}"/>
                <TextBlock Text="{Binding PreparedDate, StringFormat=\{0:dd/MM/yyyy\}}"
                           Style="{StaticResource ValueStyle}"/>
            </StackPanel>

            <StackPanel Grid.Column="1"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Bottom">
                <TextBlock Text="Quality Approved:"
                           Style="{StaticResource LabelStyle}"/>
                <Rectangle Height="1"
                           Fill="#D3D8DE"
                           Margin="0,0,0,8"/>
                <TextBlock Text="Date:"
                           Style="{StaticResource LabelStyle}"/>
                <TextBlock Text="{Binding QualityDate, StringFormat=\{0:dd/MM/yyyy\}}"
                           Style="{StaticResource ValueStyle}"/>
            </StackPanel>

            <Button Grid.Column="2"
                    Content="Print"
                    Style="{StaticResource PrintButtonStyle}"
                    Width="100"
                    Height="32"
                    Margin="20,0,0,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Click="PrintButton_Click"
                    ToolTip="Print the packing slip"/>
        </Grid>
    </Grid>
</Window>